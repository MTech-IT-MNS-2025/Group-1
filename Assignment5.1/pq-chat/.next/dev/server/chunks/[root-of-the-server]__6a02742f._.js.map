{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///home/suraj/Desktop/1st_sem/ic3/pq-chat/utils/mongo.js"],"sourcesContent":["// utils/mongo.js\nconst mongoose = require(\"mongoose\");\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/pqchat\";\n\nif (!MONGODB_URI) {\n  throw new Error(\"Please define the MONGODB_URI environment variable\");\n}\n\nlet cached = global.mongoose;\nif (!cached) {\n  cached = global.mongoose = { conn: null, promise: null };\n}\n\nasync function connect() {\n  if (cached.conn) return cached.conn;\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false\n    };\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      return mongoose;\n    });\n  }\n  cached.conn = await cached.promise;\n  return cached.conn;\n}\n\nmodule.exports = connect;\n\n"],"names":[],"mappings":"AAAA,iBAAiB;AACjB,MAAM;AAEN,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C;;AAIA,IAAI,SAAS,yDAAO,QAAQ;AAC5B,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE,OAAO,OAAO,IAAI;IACnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QACA,OAAO,OAAO,GAAG,SAAS,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AACpB;AAEA,OAAO,OAAO,GAAG"}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///home/suraj/Desktop/1st_sem/ic3/pq-chat/models/User.js"],"sourcesContent":["// models/User.js\nconst mongoose = require(\"mongoose\");\n\nconst UserSchema = new mongoose.Schema({\n  username: { type: String, unique: true, required: true },\n\n  // PQC Public Key (base64 string)\n  pqPublicKey: { type: String, default: \"\" },\n\n  createdAt: { type: Date, default: Date.now }\n});\n\nmodule.exports = mongoose.models.User || mongoose.model(\"User\", UserSchema);\n\n"],"names":[],"mappings":"AAAA,iBAAiB;AACjB,MAAM;AAEN,MAAM,aAAa,IAAI,SAAS,MAAM,CAAC;IACrC,UAAU;QAAE,MAAM;QAAQ,QAAQ;QAAM,UAAU;IAAK;IAEvD,iCAAiC;IACjC,aAAa;QAAE,MAAM;QAAQ,SAAS;IAAG;IAEzC,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;AAEA,OAAO,OAAO,GAAG,SAAS,MAAM,CAAC,IAAI,IAAI,SAAS,KAAK,CAAC,QAAQ"}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///home/suraj/Desktop/1st_sem/ic3/pq-chat/pages/api/register.js"],"sourcesContent":["// pages/api/register.js\nimport dbConnect from \"../../utils/mongo\";\nimport User from \"../../models/User\";\n\nexport default async function handler(req, res) {\n  await dbConnect();\n\n  if (req.method === \"POST\") {\n    const { username, pqPublicKey } = req.body;\n\n    if (!username) {\n      return res.status(400).json({ error: \"username required\" });\n    }\n\n    try {\n      let user = await User.findOne({ username });\n\n      if (user) {\n        // Update only public key if new one is provided\n        if (pqPublicKey) user.pqPublicKey = pqPublicKey;\n        await user.save();\n        return res.status(200).json({ ok: true, user });\n      }\n\n      user = await User.create({\n        username,\n        pqPublicKey: pqPublicKey || \"\"\n      });\n\n      return res.status(201).json({ ok: true, user });\n\n    } catch (err) {\n      return res.status(500).json({ error: err.message });\n    }\n  }\n\n  return res.status(405).json({ error: \"Method not allowed\" });\n}\n\n"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AACxB;AACA;;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,MAAM,IAAA,kHAAS;IAEf,IAAI,IAAI,MAAM,KAAK,QAAQ;QACzB,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,GAAG,IAAI,IAAI;QAE1C,IAAI,CAAC,UAAU;YACb,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO;YAAoB;QAC3D;QAEA,IAAI;YACF,IAAI,OAAO,MAAM,kHAAI,CAAC,OAAO,CAAC;gBAAE;YAAS;YAEzC,IAAI,MAAM;gBACR,gDAAgD;gBAChD,IAAI,aAAa,KAAK,WAAW,GAAG;gBACpC,MAAM,KAAK,IAAI;gBACf,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;oBAAE,IAAI;oBAAM;gBAAK;YAC/C;YAEA,OAAO,MAAM,kHAAI,CAAC,MAAM,CAAC;gBACvB;gBACA,aAAa,eAAe;YAC9B;YAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,IAAI;gBAAM;YAAK;QAE/C,EAAE,OAAO,KAAK;YACZ,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;gBAAE,OAAO,IAAI,OAAO;YAAC;QACnD;IACF;IAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,OAAO;IAAqB;AAC5D"}}]
}