{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///home/suraj/Desktop/1st_sem/ic3/pq-chat/utils/mongo.js"],"sourcesContent":["// utils/mongo.js\nconst mongoose = require(\"mongoose\");\n\nconst MONGODB_URI = process.env.MONGODB_URI || \"mongodb://localhost:27017/pqchat\";\n\nif (!MONGODB_URI) {\n  throw new Error(\"Please define the MONGODB_URI environment variable\");\n}\n\nlet cached = global.mongoose;\nif (!cached) {\n  cached = global.mongoose = { conn: null, promise: null };\n}\n\nasync function connect() {\n  if (cached.conn) return cached.conn;\n  if (!cached.promise) {\n    const opts = {\n      bufferCommands: false\n    };\n    cached.promise = mongoose.connect(MONGODB_URI, opts).then((mongoose) => {\n      return mongoose;\n    });\n  }\n  cached.conn = await cached.promise;\n  return cached.conn;\n}\n\nmodule.exports = connect;\n\n"],"names":[],"mappings":"AAAA,iBAAiB;AACjB,MAAM;AAEN,MAAM,cAAc,QAAQ,GAAG,CAAC,WAAW,IAAI;AAE/C;;AAIA,IAAI,SAAS,yDAAO,QAAQ;AAC5B,IAAI,CAAC,QAAQ;IACX,SAAS,yDAAO,QAAQ,GAAG;QAAE,MAAM;QAAM,SAAS;IAAK;AACzD;AAEA,eAAe;IACb,IAAI,OAAO,IAAI,EAAE,OAAO,OAAO,IAAI;IACnC,IAAI,CAAC,OAAO,OAAO,EAAE;QACnB,MAAM,OAAO;YACX,gBAAgB;QAClB;QACA,OAAO,OAAO,GAAG,SAAS,OAAO,CAAC,aAAa,MAAM,IAAI,CAAC,CAAC;YACzD,OAAO;QACT;IACF;IACA,OAAO,IAAI,GAAG,MAAM,OAAO,OAAO;IAClC,OAAO,OAAO,IAAI;AACpB;AAEA,OAAO,OAAO,GAAG"}},
    {"offset": {"line": 50, "column": 0}, "map": {"version":3,"sources":["file:///home/suraj/Desktop/1st_sem/ic3/pq-chat/models/Message.js"],"sourcesContent":["// models/Message.js\nconst mongoose = require(\"mongoose\");\n\nconst MessageSchema = new mongoose.Schema({\n  sender: { type: String, required: true },\n  receiver: { type: String, required: true },\n  // plaintext text for classic non-encrypted mode; for PQ mode we'll use ciphertext fields\n  text: { type: String, default: null },\n  // PQ fields (nullable)\n  kemCiphertext: { type: String, default: null }, // base64\n  aesIv: { type: String, default: null }, // base64\n  ciphertext: { type: String, default: null }, // base64 AES-GCM output (ciphertext+tag)\n  timestamp: { type: Date, default: Date.now }\n});\n\nmodule.exports = mongoose.models.Message || mongoose.model(\"Message\", MessageSchema);\n\n"],"names":[],"mappings":"AAAA,oBAAoB;AACpB,MAAM;AAEN,MAAM,gBAAgB,IAAI,SAAS,MAAM,CAAC;IACxC,QAAQ;QAAE,MAAM;QAAQ,UAAU;IAAK;IACvC,UAAU;QAAE,MAAM;QAAQ,UAAU;IAAK;IACzC,yFAAyF;IACzF,MAAM;QAAE,MAAM;QAAQ,SAAS;IAAK;IACpC,uBAAuB;IACvB,eAAe;QAAE,MAAM;QAAQ,SAAS;IAAK;IAC7C,OAAO;QAAE,MAAM;QAAQ,SAAS;IAAK;IACrC,YAAY;QAAE,MAAM;QAAQ,SAAS;IAAK;IAC1C,WAAW;QAAE,MAAM;QAAM,SAAS,KAAK,GAAG;IAAC;AAC7C;AAEA,OAAO,OAAO,GAAG,SAAS,MAAM,CAAC,OAAO,IAAI,SAAS,KAAK,CAAC,WAAW"}},
    {"offset": {"line": 89, "column": 0}, "map": {"version":3,"sources":["file:///home/suraj/Desktop/1st_sem/ic3/pq-chat/pages/api/messages.js"],"sourcesContent":["// pages/api/messages.js\nimport connectDB from \"../../utils/mongo\";\nimport Message from \"../../models/Message\";\n\nexport default async function handler(req, res) {\n  await connectDB();\n\n  const { user1, user2 } = req.query;\n\n  if (!user1 || !user2) {\n    return res.status(400).json({ error: \"Missing users\" });\n  }\n\n  const messages = await Message.find({\n    $or: [\n      { sender: user1, receiver: user2 },\n      { sender: user2, receiver: user1 }\n    ]\n  }).sort({ timestamp: 1 });\n\n  res.json(messages);\n}\n\n"],"names":[],"mappings":"AAAA,wBAAwB;;;;;AACxB;AACA;;;AAEe,eAAe,QAAQ,GAAG,EAAE,GAAG;IAC5C,MAAM,IAAA,kHAAS;IAEf,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,IAAI,KAAK;IAElC,IAAI,CAAC,SAAS,CAAC,OAAO;QACpB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAgB;IACvD;IAEA,MAAM,WAAW,MAAM,qHAAO,CAAC,IAAI,CAAC;QAClC,KAAK;YACH;gBAAE,QAAQ;gBAAO,UAAU;YAAM;YACjC;gBAAE,QAAQ;gBAAO,UAAU;YAAM;SAClC;IACH,GAAG,IAAI,CAAC;QAAE,WAAW;IAAE;IAEvB,IAAI,IAAI,CAAC;AACX"}}]
}